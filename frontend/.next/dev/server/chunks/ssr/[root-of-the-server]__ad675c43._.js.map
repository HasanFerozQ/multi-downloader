{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Hasan-PC/Desktop/multi-downloader/frontend/app/page.tsx"],"sourcesContent":["\"use client\";\nimport { useState } from \"react\";\nimport axios from \"axios\";\nimport { Download, Link2, Monitor, Music, CheckCircle, Loader2, AlertCircle } from \"lucide-react\";\n\nconst BACKEND = \"http://localhost:8000\";\nconst WS_BACKEND = \"ws://localhost:8000\";\n\nexport default function Home() {\n  const [url, setUrl] = useState(\"\");\n  const [videoData, setVideoData] = useState<any>(null);\n  const [loading, setLoading] = useState(false);\n  const [downloadProgress, setProgress] = useState<any>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  const handleAnalyze = async () => {\n    setLoading(true);\n    setError(null);\n    setVideoData(null);\n    try {\n      const res = await axios.get(`${BACKEND}/analyze`, { params: { url: url.trim() } });\n      setVideoData(res.data);\n    } catch (err: any) {\n      setError(err.response?.data?.detail || \"Error analyzing link. Check your backend.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const triggerBrowserDownload = (taskId: string, title: string) => {\n    // FIX: Pass the title to the backend so the file is named correctly\n    const downloadUrl = `${BACKEND}/download/file/${taskId}?title=${encodeURIComponent(title)}`;\n    const link = document.createElement(\"a\");\n    link.href = downloadUrl;\n    link.setAttribute(\"download\", `${title}.mp4`);\n    document.body.appendChild(link);\n    link.click();\n    link.remove();\n  };\n\n  const handleDownload = async (formatId: string) => {\n    setError(null);\n    try {\n      const { data } = await axios.get(`${BACKEND}/download/start`, {\n        params: { url: url.trim(), format_id: formatId }\n      });\n\n      const ws = new WebSocket(`${WS_BACKEND}/ws/progress/${data.task_id}`);\n      \n      ws.onmessage = (event) => {\n        const msg = JSON.parse(event.data);\n        setProgress({ progress: msg.progress, status: msg.status });\n        \n        if (msg.status === \"Finished\") {\n          // Dynamic Naming based on the video title\n          triggerBrowserDownload(data.task_id, videoData.title);\n          setProgress(null);\n          ws.close();\n        }\n\n        if (msg.status === \"Error\") {\n          setError(msg.message || \"Download failed.\");\n          setProgress(null);\n          ws.close();\n        }\n      };\n    } catch (err: any) {\n      setError(err.response?.data?.detail || \"Failed to start download.\");\n    }\n  };\n\n  return (\n    <main className=\"min-h-screen bg-[#0f172a] text-slate-200 flex flex-col items-center p-6 font-sans\">\n      {/* Dynamic Background */}\n      <div className=\"fixed top-0 left-0 w-full h-full overflow-hidden -z-10\">\n        <div className=\"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-blue-900/20 blur-[120px] rounded-full\"></div>\n        <div className=\"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-purple-900/20 blur-[120px] rounded-full\"></div>\n      </div>\n\n      <div className=\"max-w-4xl w-full pt-16\">\n        <header className=\"text-center mb-12\">\n          <h1 className=\"text-6xl font-extrabold tracking-tight bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent mb-4\">\n            Pro StreamDown\n          </h1>\n          <p className=\"text-slate-400 text-lg\">High-speed 1080p video & 320kbps MP3 downloader</p>\n        </header>\n\n        {/* Input Section */}\n        <div className=\"relative group max-w-2xl mx-auto mb-8\">\n          <div className=\"absolute -inset-1 bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl blur opacity-25 group-hover:opacity-50 transition duration-1000\"></div>\n          <div className=\"relative flex items-center bg-[#1e293b] rounded-2xl p-2 border border-slate-700\">\n            <Link2 className=\"ml-4 text-slate-500\" />\n            <input \n              className=\"flex-1 p-4 bg-transparent outline-none text-white placeholder-slate-500\"\n              placeholder=\"YouTube, X, TikTok, FB, or IG link...\"\n              value={url}\n              onChange={(e) => setUrl(e.target.value)}\n              onKeyDown={(e) => e.key === 'Enter' && handleAnalyze()}\n            />\n            <button \n              onClick={handleAnalyze} \n              disabled={loading}\n              className=\"bg-blue-600 hover:bg-blue-500 px-8 py-3 rounded-xl font-bold transition-all flex items-center gap-2\"\n            >\n              {loading ? <Loader2 className=\"animate-spin\" /> : \"Analyze\"}\n            </button>\n          </div>\n        </div>\n\n        {/* Error Visibility Section */}\n        {error && (\n          <div className=\"max-w-2xl mx-auto mb-8 flex items-center gap-3 bg-red-500/10 border border-red-500/50 p-4 rounded-xl text-red-400\">\n            <AlertCircle size={20} />\n            <p className=\"text-sm font-medium\">{error}</p>\n          </div>\n        )}\n\n        {/* Live Progress Bar */}\n        {downloadProgress && (\n          <div className=\"max-w-2xl mx-auto mb-8 bg-[#1e293b] p-6 rounded-2xl border border-blue-500/30\">\n            <div className=\"flex justify-between mb-2 text-sm font-medium\">\n              <span className=\"text-blue-400\">{downloadProgress.status}...</span>\n              <span>{Math.round(downloadProgress.progress)}%</span>\n            </div>\n            <div className=\"w-full bg-slate-800 rounded-full h-3 overflow-hidden\">\n              <div \n                className=\"bg-gradient-to-r from-blue-500 to-purple-500 h-full transition-all duration-300 shadow-[0_0_15px_rgba(59,130,246,0.5)]\" \n                style={{width: `${downloadProgress.progress}%`}}\n              ></div>\n            </div>\n          </div>\n        )}\n\n        {/* Result Card */}\n        {videoData && (\n          <div className=\"grid md:grid-cols-2 gap-8 bg-[#1e293b]/50 backdrop-blur-xl p-8 rounded-[2rem] border border-slate-700 shadow-2xl animate-in fade-in slide-in-from-bottom-4 duration-500\">\n            <div className=\"relative aspect-video rounded-2xl overflow-hidden group\">\n              <img src={videoData.thumbnail} className=\"object-cover w-full h-full transition-transform duration-500 group-hover:scale-110\" alt=\"thumbnail\" />\n              <div className=\"absolute bottom-3 right-3 bg-black/80 backdrop-blur-md px-3 py-1 rounded-lg text-xs font-mono border border-white/10\">\n                {videoData.duration}s\n              </div>\n            </div>\n            \n            <div className=\"flex flex-col justify-between\">\n              <div>\n                <h2 className=\"text-2xl font-bold text-white mb-2 leading-tight line-clamp-2\">{videoData.title}</h2>\n                <div className=\"flex items-center gap-4 text-slate-400 text-xs mb-6 font-medium\">\n                  <span className=\"flex items-center gap-1\"><CheckCircle size={14} className=\"text-green-500\" /> {videoData.uploader}</span>\n                </div>\n              </div>\n\n              <div className=\"space-y-4\">\n                <p className=\"text-[10px] font-bold uppercase tracking-[0.2em] text-slate-500\">Quality Options</p>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  {videoData.formats.map((f: any) => (\n                    <button \n                      key={f.id} \n                      onClick={() => handleDownload(f.id)} \n                      className=\"group flex items-center justify-between bg-slate-800/50 hover:bg-blue-600/20 p-4 rounded-xl border border-slate-700 hover:border-blue-500/50 transition-all text-left\"\n                    >\n                      <div className=\"flex items-center gap-3\">\n                        <Monitor size={18} className=\"text-blue-400 group-hover:scale-110 transition-transform\" />\n                        <div>\n                          <p className=\"text-sm font-bold text-white\">{f.quality}</p>\n                          <p className=\"text-[9px] text-slate-500 uppercase\">MP4 Video</p>\n                        </div>\n                      </div>\n                      <Download size={14} className=\"text-slate-600 group-hover:text-blue-400\" />\n                    </button>\n                  ))}\n                  <button \n                    onClick={() => handleDownload(\"mp3\")} \n                    className=\"group flex items-center justify-between bg-slate-800/50 hover:bg-purple-600/20 p-4 rounded-xl border border-slate-700 hover:border-purple-500/50 transition-all text-left\"\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <Music size={18} className=\"text-purple-400 group-hover:scale-110 transition-transform\" />\n                      <div>\n                        <p className=\"text-sm font-bold text-white\">HQ Audio</p>\n                        <p className=\"text-[9px] text-slate-500 uppercase\">320kbps MP3</p>\n                      </div>\n                    </div>\n                    <Download size={14} className=\"text-slate-600 group-hover:text-purple-400\" />\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </main>\n  );\n}"],"names":[],"mappings":"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"}}]
}